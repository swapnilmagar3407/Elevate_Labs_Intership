import requests

# --- SQL Injection Check ---
def check_sql_injection(url):
    payload = "' OR '1'='1"
    try:
        resp = requests.get(url, params={"id": payload}, timeout=5)
        if "error" in resp.text.lower() or "sql" in resp.text.lower():
            return {"vulnerability": "SQL Injection", "payload": payload, "url": url}
    except Exception:
        pass
    return None


# --- XSS Check ---
def check_xss(url):
    payload = "<script>alert(1)</script>"
    try:
        resp = requests.get(url, params={"q": payload}, timeout=5)
        if payload in resp.text:
            return {"vulnerability": "Reflected XSS", "payload": payload, "url": url}
    except Exception:
        pass
    return None


# --- Open Redirect Check ---
def check_open_redirect(url):
    payload = "http://evil.com"
    try:
        resp = requests.get(url, params={"next": payload}, allow_redirects=False, timeout=5)
        if "evil.com" in resp.headers.get("Location", ""):
            return {"vulnerability": "Open Redirect", "payload": payload, "url": url}
    except Exception:
        pass
    return None


# --- CSRF Check (simplified) ---
def check_csrf(url):
    try:
        resp = requests.get(url, timeout=5)
        if "csrf" not in resp.text.lower():
            return {"vulnerability": "Missing CSRF Token", "url": url}
    except Exception:
        pass
    return None
